2005-03-14  Fred Kiefer <FredKiefer@gmx.de>

	* Source/NSMatrix.m:
	([_renewRows:columns:rowSpace:colSpace:]) Corrected last patch so
	that the open panel works again. Initialize all new cells, not
	just the requested ones.

2005-03-14  Richard Frith-Macdonald <rfm@gnu.org>

	* Source/NSMatrix.m:
	([removeRow:]) set column counts to zero if all rows are removed
	([removeColumn:]) set row counts to zero if all columns are removed
	([_renewRows:columns:rowSpace:colSpace:]) initialise all columns of
	any newly created rows (up to _maxCols) rather than just the number
	specified by the method argument.  Otherwise we get uninitialised
	columns in the matrix which will cause a crash when they are used.
	Fixes bug #12299

2005-03-13  Richard Frith-Macdonald <rfm@gnu.org>

	* Headers/AppKit/NSGraphics.h: Fix prototype for stricter compiler.
	* Source/Functions.m: ditto
	Deal with bug #12296

2005-03-10  Nicola Pero <n.pero@mi.flashnet.it>

	* Headers/AppKit/AppKitDefines.h (GS_EXPORT): Use extern, not
	__declspec(dllexport), on mingw
	
2005-03-10  Nicola Pero <n.pero@mi.flashnet.it>

	* configure.ac: Fixed setting variable when libjpeg can't be found.
	* configure: Regenereated.

2005-03-07  Fred Kiefer <FredKiefer@gmx.de>

	* Header/AppKit/NSCell.h: Moved NSControlSize definition to ...
	* Header/AppKit/NSColor.h: ... here and added
	NSMiniControlSize. For NSControlTint added NSBlueControlTint and
	NSGraphiteControlTint.
	* Header/AppKit/NSFont.h (+menuBarFontOfSize:,
	+systemFontSizeForControlSize:, -numberOfGlyphs,
	-coveredCharacterSet, -fontDescriptor): New MacOSX 10.3 methods.
	* Source/NSFont.m: Added dummy implementations for the new methods. 

2005-03-05 Adrian Robert <arobert@cogsci.ucsd.edu>

	* Source/NSApplication.m (-_windowDidResignKey:) Unhide mouse.

2005-03-05 Adrian Robert <arobert@cogsci.ucsd.edu>

	* Source/NSScroller.m (-checkSpaceForParts, -rectForPart:) Calculate
	buttonsWidth variable dynamically based on +scrollerWidth (supports
	width override by subclass).

2005-03-05 10:53 Gregory John Casamento <greg_casamento@yahoo.com>

	* Headers/AppKit/NSDataLink.h
	* Headers/AppKit/NSDataLinkManager.h: Added some ivars
	* Source/Functions.m: Changed the NSLinkFrameThickness() function to
	return 1 instead of 1.5.
	* Source/NSDataLink.m: Implemented several methods.
	* Source/NSDataLinkManager.m: Implemented several methods.
	* Source/NSDataLinkPanel.m: Change version from 1 to 0.
	* Source/NSSelection.m: Change version from 1 to 0, corrected 
	but in initWithCoder:.

2005-03-03  Adam Fedor  <fedor@gnu.org>

	* configure.ac: Disable gsnd on darwin
	
	* Tools/GNUmakefile.preamble (GSspell_TOOL_LIBS): Add lib depends.

2005-02-27 Adrian Robert <arobert@cogsci.ucsd.edu>

	* Source/NSApplication.m (-runModalForWindow:) Clarify gsdoc
	explaining why we don't follow Apple docs here.  (Corrects gsdoc
	from change on 2005-01-26, which itself documented a code change on
	2005-01-18.)

2005-02-26 18:04  Alexander Malmberg  <alexander@malmberg.org>

	* Headers/Additions/GNUstepGUI/GSServicesManager.h: Include the
	NSMenuItem.h header instead of forward declaring the NSMenuItem
	protocol.

2005-02-23  Fred Kiefer <FredKiefer@gmx.de>

	* Header/AppKit/NSColor.h (-alternateSelectedControlColor,
	-alternateSelectedControlTextColor,
	-secondarySelectedControlColor,
	controlAlternatingRowBackgroundColors): New MacOSX system colour methods.
	* Source/NSColor.m (-alternateSelectedControlColor,
	-alternateSelectedControlTextColor,
	-secondarySelectedControlColor,
	controlAlternatingRowBackgroundColors): Implemented the new
	methods.
	(initSystemColors): Added default values for new system coloure methods

2005-02-21  Fred Kiefer <FredKiefer@gmx.de>

	* Source/NSCell.m (-initWithCoder):
	* Source/NSButtonCell.m (-initWithCoder):
	* Source/NSBrowser.m (-initWithCoder):
	Small improvements on keyed decoding of flags.

2005-02-19  Fred Kiefer <FredKiefer@gmx.de>

	* Source/NSSavePanel.m (-_setDefaultDirectory): New method to get
	default directory from user defaults (NSDefaultOpenDirectory).
	(-_resetDefaults): Use it for setting of default directory.
	(-_setupForDirectory:file:): Use the new method here as well if no
	path is provided. Cleaned up this method.
	(-cancel:) Don't clean up filename and set directory to current.
	(-ok:) Don't set _OKButtonPressed.
	* Source/NSOpenPanel.m (-ok:): Don't set _OKButtonPressed.
	(-_setupForDirectory:file:): Removed code duplicating super class
	implementation. 
	This fixes most of bug #7900.

2005-02-14  Fred Kiefer <FredKiefer@gmx.de>

	* Source/NSPopupButton.m (-mouseDown:): Moved code from here ...
	* Source/NSPopupButtonCell.m
	(-trackMouse:inRect:ofView:untilMouseUp:): ... to here. This fixes
	bug #9824.

2005-02-14  Richard Frith-Macdoanld <rfm@gnu.org>

	* Source/GSTitleView.m (-mouseDown:): Post an
	NSWindowDidMoveNotification at end of method if window was dragged.
	Fixes bug #11906

2005-02-12  Fred Kiefer <FredKiefer@gmx.de>

	* Headers/Additions/GNUstepGUI/GSDisplayServer.h (-setalpha::): Declare.
	* Source/GSDisplayServer.m (-setalpha::): New method for window
	alpha setting, with empty default implementation.
	* Source/NSWindow.m (-setAlphaValue:): Implemented alpha setting
	via display server.
	(-_initDefaults): Set _alphaValue to 1.0.

2005-02-12  Fred Kiefer <FredKiefer@gmx.de>

	* Model/GMAppKit.m (NSButtonCell-initWithModelUnarchiver:):
	Resorted code to work around AppKit change on button type
	handling. Patch by Georg Fleischmann <georg@vhf.de>	

2005-02-12  Fred Kiefer <FredKiefer@gmx.de>

	* Source/NSAffineTransform.m (-boundingRectFor:result:): Further
	corrections on last change.

2005-02-11  Fred Kiefer <FredKiefer@gmx.de>

	* Source/NSAffineTransform.m (-boundingRectFor:result:):
	Corrected algorithm to compute bounding box for transformed
	rectangle (Code based on Cairo). This fixes bug #11562.

2005-02-08  Matt Rice  <ratmice@yahoo.com>

	* Source/NSApplication.m (-changeWindowsItem:title:filename:): If the
	window can become key, use makeKeyAndOrderFront: as the action.
	(-updateWindowsItem:, -setWindowsMenu): Compare the title to what it
	would be if there was a represented filename, not the filename.
	* Source/NSApplication.m (-orderWindow:relativeTo:): Ditto.
	(-setExcludedFromWindowsMenu): Ditto.

2005-02-08  Fred Kiefer <FredKiefer@gmx.de>

	* Source/NSSecureTextField.m (-drawInteriorWithFrame:inView:):
	Draw the background colour of the cell.
	
2005-02-07  Fred Kiefer <FredKiefer@gmx.de>

	* Source/NSTableView.m (-expandItem:expandChildren:,
	collapseItem:collapseChildren:): Added a call to setNeedsDisplay:,
	so the new status will be shown correctly.
	(_openItem:): Removed setNeedsDisplay: call as all callers do it already.

2005-02-05 15:42 Gregory John Casamento <greg_casamento@yahoo.com>

	* Headers/AppKit/NSDataLinkManager.h: Moved NSDataLinkManager delegate
	methods to an informal protocol NSDataLinkManagerDelegate.
	* Source/Functions.m: Implemented NSFrameLinkRect() to draw the frames
	around source and destination links.
	* Source/NSBundleAdditions.m: Modified -description method in 
	NSNibConnector to display the source, destination and label for the
	connection.  This makes it easier to debug.
	* Source/NSDataLink.m: Implemented a few private methods.
	* Source/NSDataLinkManager.m: Implemented -breakAllLinks.

2005-02-03 10:54  Alexander Malmberg  <alexander@malmberg.org>

	* Source/NSImage.m (min, max): Rename to ...
	(gs_min, gs_max): ... this. Update callers.

2005-01-28 21:58 Gregory John Casamento <greg_casamento@yahoo.com>

	* Source/NSColorWell.m: [NSColorWell mouseDown:] prevent use
	of the colorwell when it's disabled.

2005-01-28 17:57  Alexander Malmberg  <alexander@malmberg.org>

	* Source/NSImageCell.m (-drawInteriorWithFrame:inView:): If our
	view is flipped, flip the image.

2005-01-26 Adrian Robert <arobert@cogsci.ucsd.edu>

	* Source/NSApplication.m (-beginModalSessionforWindow:): Center
	panels only if they are not already up, matching OS X Panther;
	document.
	(-runModalForWindow:, -runModalSession:): Clarify documentation.

2005-01-25 01:05  Alexander Malmberg  <alexander@malmberg.org>

	* Source/NSImageCell.m (-drawInteriorWithFrame:inView:): Use
	-drawInRect:fromRect:operation:fraction: to draw the image.

2005-01-25 00:29  Alexander Malmberg  <alexander@malmberg.org>

	* Headers/AppKit/NSImage.h (-drawAtPoint:fromRect:fraction:)
	(-drawInRect:fromRect:operation:fraction:): Document.
	* Source/NSImage.m -drawAtPoint:fromRect:fraction:)
	(-drawInRect:fromRect:operation:fraction:): Implement.
	(min, max): New functions.
	(-drawRepresentation:inRect:): Save the gstate before drawing
	and restore it afterwards.

	Fixes bug #11712.

2005-01-24 16:57  Alexander Malmberg  <alexander@malmberg.org>

	* Source/NSPopUpButtonCell.m (-synchronizeTitleAndSelectedItem): For
	non-pulldowns, make sure the selected item and the highlighted item
	are the same.

2005-01-24  Quentin Mathe  <qmathe@club-internet.fr>

	* Source/GSToolbarView.m (initSystemExtensionsColors()): Removed 
	spurious 'else' (introduced with revision 1.11) which prevented toolbar 
	colors loading code to be executed (Fix the white toolbar background bug
	reported by Riccardo Mottola).

2005-01-24 Adrian Robert <arobert@cogsci.ucsd.edu>

	* Source/NSSavePanel.m (-_shouldShowExtension:isDir:,
	-setRequiredFileType:, -requiredFileType, -filename): For filename
	display filtering, handle case where _requiredFileType is unset or
	set to nil or "" by allowing any extension (including none), as
	specified in Apple docs, instead of allowing no extensions, as it
	was.  Document.

2005-01-24 00:48  Alexander Malmberg  <alexander@malmberg.org>

	* Source/NSImageCell.m (-drawInteriorWithFrame:inView:): Draw
	the image using the right size, but don't scale it. Work around
	bug #11712.

2005-01-22 Adrian Robert <arobert@cogsci.ucsd.edu>

	* Source/NSFontManager.m (-fontWithFamily:traits:weight:size:)
	Corrected logic in fallback approximate trait search for weight 5 or 6
	(regular) fonts. Font w/approximate traits but originally-requested
	weight will now be found.
	
2005-01-21 21:43  Alexander Malmberg  <alexander@malmberg.org>

	Various whitespace cleanups, comment type fixes, and changes
	to avoid warnings from recent versions of gcc.

	* Headers/Additions/GNUstepGUI/GSToolbar.h (-_toolbars): Declare.
	* Source/NSWindow+Toolbar.m: Remove conflicting declaration of
	[NSToolbar -_toolbars].

	* Headers/Additions/GNUstepGUI/GSServicesManager.h,
 	Source/GSServicesMananger.m (-item2title:, -validateMenuItem:):
	Adjust argument types.
	* Headers/AppKit/NSMenu.h (-validateMenuItem:): Adjust argument
	type.

	* Source/NSTextView.m (-sizeToFit): Don't use size uninitialized
	if neither resizable flags is set.
	(-insertText:): Adjust argument type.
	* Headers/AppKit/NSResponder.h, Source/NSResponder.m (-insertText:):
	Adjust argument type. Document.

	* Headers/AppKit/NSView.h: Change type of ivar _window to NSWindow *.

	* Source/GSTitleView.m (-mouseDown:): Always initialize
	startWindowOrigin.
	* Source/NSApplication.m (-setApplicationIconImage:): Add casts
	to avoid warnings.
	* Source/NSCell.m (-cellSize): Add default: case.
	* Source/NSPasteboard.m
	([GSFiltered -pasteboard:provideDataForType:]): Detect and warn if we
	can't find a filter that will get us the desired type.
	* Source/NSProgressIndicator.m: Comment out unused variable 'images'.
	* Source/NSBezierPath.m: Declare GSBezierPath fully before using it.
	(-bezierPathByFlatteningPath, -bezierPathByReversingPath): Make sure
	variables are always initialized.

	* Source/NSMenuView.m,
	* Source/NSPrintOperation.m,
	* Source/NSSplitView.m,
	* Source/NSTableHeaderView.m: Make sure variables are always
	initialized.

	* Source/NSBox.m,
	* Source/NSImageview.m,
	* Source/NSText.m,
	* Source/NSTextStorage.m: Add missing includes.

	* Source/GSKeyBindingTable.m,
	* Source/GSLayoutManager.m,
	* Source/NSBitmapImageRep+PNM.m,
	* Source/NSBundleAdditions.m,
	* Source/NSLayoutManager.m,
	* Source/nsimage-tiff.h,
	* Source/tiff.m,
	* Headers/Additions/GNUstepGUI/GSDisplayServer.h,
	* Source/GSDisplayServer.m: Change signedness of various variables.

	* Source/NSPanel.m (-sendEvent:): Remove.
	* Source/NSWindow.m (-becomesKeyOnlyIfNeeded): New method.
	(-_sendEvent:becomesKeyOnlyIfNeeded:): Remove. Move code ...
	(-sendEvent:): ... here. Use -becomesKeyOnlyIfNeeded instead
	of the argument.

2005-01-21  Quentin Mathe  <qmathe@club-internet.fr>

	* Source/GSToolbarView.m:
	* Headers/Additions/GNUstepGUI/GSToolbarView.h:
	Renamed the NSColor(Extensions) category with the more descriptive name 
	NSColor(GSToolbarViewAdditions). This modification permits GNUMail 
	compilation with recent Darwin linker versions which prevented it 
	because GNUMail has a NSColor category identically named "Extensions".

2005-01-20  Fred Kiefer <FredKiefer@gmx.de>

	* Source/NSTableView.m (-rowAtPoint:): If the heigh of the table
	is incorrect and because of this the row would be greater than the
	number of rows, return a usable number.

2005-01-18 17:06  Alexander Malmberg  <alexander@malmberg.org>

	* Source/NSWindow.m
	(-initWithContentRect:styleMask:backing:defer:screen:): Assert that
	the shared application instance has been created instead of just
	calling NSLog. Make the message clearer.

2005-01-18 16:53  Alexander Malmberg  <alexander@malmberg.org>

	* Source/NSCell.m (-setUpFieldEditorAttributes:): Clear the
	text object's string.
	* Source/NSControl.m (-setDoubleValue:, -setFloatValue:)
	(-setIntValue:, -setStringValue:, -setObjectValue:): If the receiver
	was being edited when the method was called, make it the first
	responder after changing the value.
	(-abortEditing): Don't clear the text object's string.
	* Source/NSMatrix.m (-abortEditing): Don't clear the text object's
	string.
	* Source/NSTableView.m (-abortEditing): Ditto.
	* Source/NSTextField.m (-abortEditing): Ditto.

2005-01-18 16:39  Alexander Malmberg  <alexander@malmberg.org>

	* Source/NSBitmapImageRep.m
	(-TIFFRepresentationUsingCompression:factor:): Don't use pointer
	comparisons to compare strings. Handle both device and calibrated
	colorspaces. Warn if the colorspace isn't recognized.

2005-01-18 15:50  Alexander Malmberg  <alexander@malmberg.org>

	* Source/NSApplication.m (-runModalSession:): Don't order the window
	to the front or make it the key/main window.

2005-01-18 15:46  Alexander Malmberg  <alexander@malmberg.org>

	* Source/NSApplication.m (-finishLaunching): Don't attempt to open
	an untitled file if we were autolaunched.

2005-01-18 14:16  Alexander Malmberg  <alexander@malmberg.org>

	* Source/NSAffineTransform.m (pi): Correct the rounding.

2005-01-18  Matt Rice <ratmice@yahoo.com>

        * Source/NSTextView.m (setSelectedRange:): Do not make the selected
	text visible.
        (-didChangeText,-checkSpelling:): Make the selected text visible.
        * Source/NSTextView_actions.m (_moveTo:select:): Ditto.
        * Source/NSCell.m (-setUpFieldEditorAttributes:): Ditto.
        (-selectWithFrame:inView:editor:delegate:start:length:): Ditto.
        * Source/NSComboBoxCell (-validateSelection:,-textDidChange:): Ditto.

2005-01-18 14:09  Alexander Malmberg  <alexander@malmberg.org>

	* Source/Functions.m (NSDottedFrameRect, NSFrameRectWithWidth): Draw
	the frame inside the given rectangle.
	(NSDrawTiledRects): Remove documentation.
	* Headers/AppKit/NSGraphics.h (NSDottedFrameRect, NSFrameRect)
	(NSFrameRectWithWidth, NSDrawTiledRects): Add new documentation.

2005-01-17 Adrian Robert <arobert@cogsci.ucsd.edu>

	* Source/NSWindow.m (-sendEvent:becomesKeyOnlyIfNeeded:): Give
	mouseDragged events to _lastView rather than view (if exists)
	underneath mouse.

2005-01-17 Adrian Robert <arobert@cogsci.ucsd.edu>

	* Source/NSApplication.m
	(-nextEventMatchingMask:untilDate:inMode:dequeue:): Check that
	event is not 'null_event' before using it to unhide mouse.

2005-01-17  Fred Kiefer <FredKiefer@gmx.de>

	* Source/NSBrowserCell.m (-setType:): New method, does nothing to
	allow image and text at once (MacOSX 10.2 behaviour).
	(-drawInteriorWithFrame:inView:): Draw an image or alternate image,
	if provided and draw the text as well.
	
2005-01-16  Fred Kiefer <FredKiefer@gmx.de>

	* Images/common_ClosedHandCursor.tiff: Replaced by new image files by
	Fabien Vallon <fabien@sonappart.net>.

2005-01-16  Fred Kiefer <FredKiefer@gmx.de>

	* TextConverters/RTF/RTFProducer.m (-_stringWithRTFCharacters:):
	Output "\uc0" so that other applications know we don't write ANSI
	representations of Unicode characters.

2005-01-16  Fred Kiefer <FredKiefer@gmx.de>

	* Printing/GSCUPS/GSCUPSPrinter.m (+printerNames): Add dummy
	printer to list, if no printers are found.

2005-01-16 06:39 Gregory John Casamento <greg_casamento@yahoo.com>

	* Source/NSDocument.m: In validateMenuItem: added code to 
	properly set the undo/redo title and disable the menus when
	appropriate.

2005-01-15 05:59 Gregory John Casamento <greg_casamento@yahoo.com>

	* Source/NSDocument.m: Added undo:/redo: here.  Smarter use
	of the responder chain.
	* Source/NSWindow.m: Removed undo:/redo: here.

2005-01-14 16:11  Alexander Malmberg <alexander@malmberg.org>

	* Headers/AppKit/NSSavePanel.h (-panel:shouldShowFilename:):
	Document.
	* Source/NSSavePanel.m (-setDelegate:): Call -validateVisibleColumns.
	Whitespace cleanups.
	(-browser:isColumnValid:): Give the delegate the complete path to
	each file.

	Fixes bug #10553.

2005-01-14 09:25 Gregory John Casamento <greg_casamento@yahoo.com>

	* Source/NSDocument.m: Minor change.  The init method now sets the
	flag to YES so that when a undoManager is needed, it's instantiated.

2005-01-14 05:50 Gregory John Casamento <greg_casamento@yahoo.com>

	* Source/NSDocument.m: corrected undoManager call in NSDocument.

2005-01-13  Adam Fedor  <fedor@gnu.org>

	* Source/GNUmakefile.preamble: Extend FILTER_OUT flag to
	all sparc architectures.

2005-01-12 16:40  Alexander Malmberg <alexander@malmberg.org>

	* Headers/AppKit/NSBezierPath.h (-windingCountAtPoint:): Mark as
	a GNUstep extension.

2005-01-12 00:47  Alexander Malmberg <alexander@malmberg.org>

	* Source/GSStandardWindowDecorationView.m (-initWithFrame:window:):
	Create a paragraph style with line-breaking-by-clipping and use it
	for window titles.

2005-01-12 00:41  Alexander Malmberg <alexander@malmberg.org>

	* Printing/GSCUPS/GSCUPSPrinter.h (GSCUPSDummyPrinterName): New
	variable.
	* Printing/GSCUPS/GSCUPSPrinter.m (GSCUPSDummyPrinterName): New
	variable.
	(+printerWithName:): Warn and return a dummy printer when requested.
	* Printing/GSCUPS/GSCUPSPrintInfo.m (defaultPrinter): If there's
	no default CUPS printer set, return a dummy printer.

	Fixes bug #10916.

2005-01-11 23:50  Alexander Malmberg <alexander@malmberg.org>

	* Headers/AppKit/NSBezierPath.h (NSWindingRule)
 	(-containsPoint): Document.
	(-windingCountAtPoint:): New method.
	* Source/NSBezierPath.m: Remove some trailing whitespace.
	(PI): Correct rounding.
	(contribution, -contributionToContains:): Remove.
	(winding_line, winding_curve): New functions.
	(-windingCountAtPoint:): New method.
	(-containsPoint:): Use -windingCountAtPoint: instead of
	-contributionToContains:. Don't flatten the path.

2005-01-09  Matt Rice  <ratmice@yahoo.com>
	
	* Source/NSTableHeaderCell.m (-drawInteriorWithFrame:inView:): Use
	the correct background/highlight colors and NSCompositeSourceOver for
	image cells. 
	(-setHighlighted): Use controlHighlightColor instead of controlColor.

